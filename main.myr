use std

use mparse

const main = {args
	var p, cmd

	cmd = std.optparse(args, &[
		.argdesc="files..."
	])

	if cmd.args.len == 0
		p = mparse.tokinitf(0, "stdin")
		dump(p)
	else
		for arg in cmd.args
			p = mparse.tokinit(arg)
			dump(p)
		;;
	;;
}

const dump = {p
	var f

	f = mparse.file(p)
	std.put("{}\n", f)
}
