use std

use mparse

const main = {args
	var ts, cmd

	cmd = std.optparse(args, &[
		.argdesc="files..."
	])

	if cmd.args.len == 0
		ts = mparse.tokinitf(0, "stdin")
		dump(ts)
	else
		for arg in cmd.args
			ts = mparse.tokinit(arg)
			dump(ts)
		;;
	;;
}

const dump = {ts
	var f

	f = mparse.tsfile(ts)
	std.put("{}\n", f)
}
